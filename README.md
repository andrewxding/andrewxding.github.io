in progress, still need to restructure code
